*** lock.h      
***************
*** 78,85 ****
    RefCounter() : count_(1) {}

    int count() const { return count_; }
!   int Incr() const { return ++count_; }
!   int Decr() const {  return --count_; }

   private:
    mutable int count_;
--- 78,88 ----
    RefCounter() : count_(1) {}

    int count() const { return count_; }
!   // int Incr() const { return ++count_; }
!   // int Decr() const {  return --count_; }
!
!   int Incr() const { return __sync_add_and_fetch(&count_, 1); }
!   int Decr() const { return __sync_sub_and_fetch(&count_, 1); }

   private:
    mutable int count_;

